function FFSuggest(){var b=false;var B="";var J="";var m="";var A="";var y="";var c;var R=[];var f;var a=false;var t=-1;var e="";var K="";var p="";var i="";var o;var d="suggestImage";var I="suggestTextQuery";var x="suggestTextAmount";var w="suggestTextQueryTyped";var Q="suggestRow";var P="suggestHighlight";this.init=function(S,ae,X,V,ad,af,Z,aa,ac,U,Y,T,ab,W){J=S;A=ae;m=X;pChannelParamName=Z;pChannel=aa;y=V;B=ad;b=af;a=ac;K=Y;e=U;p=T;i=ab;o=W;if(J==""){if(b){alert("no searchURL defined");}return null;}else{if(B==""){if(b){alert("no instanceName defined");}return null;}else{if(A==""){if(b){alert("no formName defined");}return null;}else{if(m==""){if(b){alert("no queryParamName defined");}return null;}else{if(y==""){if(b){alert("need a layer for output");}}}}}}c=document[A][m];jQuery(c).keyup(function(ag){n(ag);});jQuery(c).keydown(function(ag){return v(ag);});jQuery(c).focus(function(){D();});jQuery(c).blur(function(){G();});jQuery(document[A]).submit(function(){return u();});ptranslation={};ptranslation["brand"]="Hersteller";ptranslation["brand.headline"]="Markenvorschl&auml;ge";ptranslation["searchTerm"]="Suchbegriff";ptranslation["searchTerm.headline"]="Suchvorschl&auml;ge";ptranslation["category"]="Kategorie";ptranslation["category.headline"]="Kategorievorschl&auml;ge";ptranslation["productName"]="Produktname";ptranslation["productName.headline"]="Produktvorschl&auml;ge";ptranslation["content"]="Inhalt";ptranslation["unspecified"]="Sonstiges";};function u(){if(R[t]!=undefined){document[A][m].value=R[t].name;return false;}return true;}this.handleClick=function(){if(jQuery("li."+P).length>0){t=jQuery("li."+P)[0].id.replace(y+"_","");}jQuery(document[A]).submit();};this.handleMouseMove=function(S){z();jQuery("#"+y+' li[id="'+S+'"]').addClass(P);};this.handleMouseOut=function(S){jQuery("#"+y+' li[id="'+S+'"]').removeClass(P);t=-1;};function n(S){S=(S)?S:((event)?event:null);var T=S.keyCode;if(T==38){E();}else{if(T==27){G();}else{if(T==40){g();}else{if(c.value==""){G();f="";return null;}if(f!=c.value){N();}f=c.value;}}}}function v(S){S=(S)?S:((event)?event:null);var U=S.keyCode;if(U==9){var T=jQuery("form[name="+A+"] input#"+m+"Underlay");if(T.length>0){jQuery("form[name="+A+"] input[name="+m+"]").attr("value",T.attr("value"));return false;}}return true;}function E(){if(jQuery("li."+P).length==0){jQuery("li."+Q+":last").addClass(P);t=R.length;}else{var S=jQuery("li."+P).prevAll("li."+Q);if(S.length==0){jQuery("li."+P).removeClass(P);jQuery("li."+Q+":last").addClass(P);t=R.length;}else{jQuery("li."+P).removeClass(P);jQuery(S[0]).addClass(P);t--;}}}function g(){if(jQuery("li."+P).length==0){jQuery("li."+Q+":first").addClass(P);t=0;}else{var S=jQuery("li."+P).nextAll("li."+Q);if(S.length==0){jQuery("li."+P).removeClass(P);jQuery("li."+Q+":first").addClass(P);t=0;}else{jQuery("li."+P).removeClass(P);jQuery(S[0]).addClass(P);t++;}}}function F(T){var S=T.indexOf("?");if(S>=0){return T.substring(S);}else{return T;}}function j(V,T){var S=V.indexOf("?"+T);if(S>=0){var U=V.substring(0,S);S=V.indexOf("&",S+1);if(S>=0){V=U+V.substring(S);}}else{S=V.indexOf("&"+T);if(S>=0){var U=V.substring(0,S);S=V.indexOf("&",S+1);if(S>=0){V=U+V.substring(S);}}}return V;}function G(){z();jQuery("div#"+y).hide();h();var S=jQuery("form[name="+A+"] input#"+m+"Underlay");if(S.length>0){jQuery("form[name="+A+"] input[name="+m+"]").css("background-color",S.css("background-color"));}}this.hideLayerOutsideCall=function(){G();};function D(){jQuery("div#"+y).show();}function O(S){if(typeof(onSuggestCompleted)=="function"){onSuggestCompleted(S);}}function h(){if(typeof(onSuggestLayerHidden)=="function"){onSuggestLayerHidden();}}function r(S){if(typeof(L)=="function"){return L(S);}}function z(){jQuery("li."+P).each(function(S){jQuery(this).removeClass(P).addClass(Q);});}function s(S){return jQuery("<div/>").text(S).html();}function N(){var T=jQuery("form[name="+A+"] input[name="+m+"]").attr("value");if(f==T){return;}else{f=T;}var S=J+"?"+m+"="+encodeURIComponent(T)+"&"+pChannelParamName+"="+pChannel+"&format=jsonp&callback=?&omitContextName=true";S=addStoreInformation(S);jQuery.getJSON(S,function(af,W){t=-1;if(af!=null&&af.length>0){var Y='<ul class="'+y+'Block" onMouseDown="'+B+'.handleClick();">';R=new Array();var ac="";var ad="";i=af[0].refKey;T=T.replace(/[^a-zA-Z0-9]/g,"\\$&");for(var aa=0;aa<af.length;aa++){if(ad==""){var X=af[aa].name;if(X.toLowerCase().indexOf(T.toLowerCase())==0){ad=T+X.substring(T.length);}}var V=af[aa].type;if(V!=ac){var ab=ptranslation[V+".headline"];if(!ab){ab=V;}ac=V;}var U=y+"_"+aa;if(V=="productName"){Y+=l(U,T,af[aa]);}else{Y+=k(U,T,af[aa]);}R[aa]=af[aa];}Y+="</ul>";var ae='<div class="search_suggest_inner" onmousedown="suggest.handleClick();"><dl><dt>Unsere Vorschläge</dt><dd>'+Y+'</dd></dl><div class="clear"></div><a class="btn_close_js" href="">✕</a></div><div class="search_suggest_shadow shadow_js" style="height: 227px;"></div>';jQuery("div#"+y).html(ae).show();M(i);C();jQuery(".btn_close_js","div#"+y).mousedown(function(ag){G();return false;});var Z=jQuery("form[name="+A+"] input#"+m+"Underlay");if(Z.length>0){Z.attr("value",ad);if(ad){jQuery("form[name="+A+"] input[name="+m+"]").css("background-color","transparent");}else{jQuery("form[name="+A+"] input[name="+m+"]").css("background-color",Z.css("background-color"));}}}else{G();}}).error(function(W,X,V,U){if(b){alert("Error:\nHTTP result code: "+W.status+"\nrequested URL: "+S);}});}function k(Y,X,T){var W=T.name;var V=T.hitCount;if(V==0){V="";}else{if(V==1){V="1 Treffer";}else{var S=V;V="{0} Treffer";V=V.replace(/\{0\}/,S);}}var U='<li id="'+Y+'" class="'+Q+'" onMouseMove="'+B+".handleMouseMove('"+Y+"');\""+'onMouseOut="'+B+".handleMouseOut('"+Y+"');\">"+'<a class="'+I+'">'+s(W)+"</a>";return U;}function l(Y,X,S){var V=S.name;var T=S.image;var W=new Image();W.onerror=function(){jQuery("#"+this.parentId+" img").first().remove();};if(T){W.src=T;W.parentId=Y;}var U='<li id="'+Y+'" class="'+Q+" "+Q+'WithImage" onMouseMove="'+B+".handleMouseMove('"+Y+"');\""+'onMouseOut="'+B+".handleMouseOut('"+Y+"');\">"+'<span class="'+d+'">';if(T){U+='<img src="'+T+'" alt=""/>';}U+="</span>"+'<a class="'+I+'">'+s(V)+"</a>";return U;}function L(T){var S=R[t].type;if(S=="productName"){var U=R[t].attributes["deeplink"];return U;}}function H(S){if(e){S=q(S,"sid",e);}if(K){S=q(S,"uid",K);}if(p){S=q(S,"site",p);}if(i){S=q(S,"sourceRefKey",i);}return S;}function q(S,T,U){if(T&&U){var V=encodeURIComponent(T)+"="+encodeURIComponent(U);if(S.indexOf("?")!==-1){S+="&"+V;}else{S+="?"+V;}}return S;}function M(S){if(o&&typeof(o)=="function"){window.setTimeout(function(){o(S);},10);}}function C(){var S=jQuery("div#navi_meta div#formSearch div#search_suggest");var T=jQuery("div.search_suggest_inner",S).height();T=parseInt(T)+2+"px";jQuery("div.search_suggest_shadow",S).css("height",T);}}